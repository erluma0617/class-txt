clc, clear, w=zeros(13); %超矩阵初始化
ri=[0 0 0.58 0.90 1.12 1.24 1.32 1.41 1.45];
a12=[1 2 3.1;1/2 1 1.6;1/3.1 1/1.6 1];
[w12,val12]=eigs(a12,1); %计算模最大的特征值及对应的特征向量
w12=w12/sum(w12), cr12=(val12-3)/(3-1)/ri(3)
a131=[1 1/3 1/4;3 1 1.5;4 1/1.5 1];
[w131,val131]=eigs(a131,1);
w131=w131/sum(w131), cr131=(val131-3)/(3-1)/ri(3)
a132=[1 1/5 1/3;5 1 2;3 1/2 1];
[w132,val132]=eigs(a132,1);
w132=w132/sum(w132), cr132=(val132-3)/(3-1)/ri(3)
a133=[1 1/2 1/1.5;2 1 3;1.5 1/3 1];
[w133,val133]=eigs(a133,1);
w133=w133/sum(w133), cr133=(val133-3)/(3-1)/ri(3)
a134=[1 5 3;1/5 1 1.5;1/3 1/1.5 1];
[w134,val134]=eigs(a134,1);
w134=w134/sum(w134), cr134=(val134-3)/(3-1)/ri(3)
a141=[1 5/4 5/3;4/5 1 4/3;3/5 3/4 1];
[w141,val141]=eigs(a141,1);
w141=w141/sum(w141), cr141=(val141-3)/(3-1)/ri(3)
a142=[1 1/2 1;2 1 2;1 1/2 1];
[w142,val142]=eigs(a142,1);
w142=w142/sum(w142), cr142=(val142-3)/(3-1)/ri(3)
a151=[1 1 1.8;1 1 1.4;1/1.8 1/1.4 1];
[w151,val151]=eigs(a151,1);
w151=w151/sum(w151), cr151=(val151-3)/(3-1)/ri(3)
a152=[1 1 3.5;1 1 3;1/3.5 1/3 1];
[w152,val152]=eigs(a152,1);
w152=w152/sum(w152), cr152=(val152-3)/(3-1)/ri(3)
a153=[1 0.8 3;1.25 1 1.5;1/3 1/1.5 1];
[w153,val153]=eigs(a153,1);
w153=w153/sum(w153), cr153=(val153-3)/(3-1)/ri(3)
a311=[1 3 9 6;1/3 1 3 4;1/9 1/3 1 3;1/6 1/4 1/3 1];
[w311,val311]=eigs(a311,1);
w311=w311/sum(w311), cr311=(val311-4)/(4-1)/ri(4)
a312=[1 4 6 3;1/4 1 2 3;1/6 1/2 1 2;1/3 1/3 1/2 1];
[w312,val312]=eigs(a312,1);
w312=w312/sum(w312), cr312=(val312-4)/(4-1)/ri(4)
a313=[1 3 5 5;1/3 1 4 5;1/5 1/4 1 3;1/5 1/5 1/3 1];
[w313,val313]=eigs(a313,1);
w313=w313/sum(w313), cr313=(val313-4)/(4-1)/ri(4)
a32=[1 2 5 8;1/2 1 8 6;1/5 1/8 1 2;1/8 1/6 1/2 1];
[w32,val32]=eigs(a32,1);
w32=w32/sum(w32), cr32=(val32-4)/(4-1)/ri(4)
a41=[1 8;1/8 1]; [w41,val41]=eigs(a41,1); w41=w41/sum(w41)
a42=[1 6;1/6 1]; [w42,val42]=eigs(a42,1); w42=w42/sum(w42)
a511=[1 3 2;1/3 1 0.8;1/2 1.25 1]; [w511,val511]=eigs(a511,1);
w511=w511/sum(w511), cr511=(val511-3)/2/ri(3)
a512=[1 1.5 1.2;2/3 1 1/2;1/1.2 2 1]; [w512,val512]=eigs(a512,1);
w512=w512/sum(w512), cr512=(val512-3)/2/ri(3)
a513=[1 2 1/2;1/2 1 1/2;2 2 1]; [w513,val513]=eigs(a513,1);
w513=w513/sum(w513), cr513=(val513-3)/2/ri(3)
a52=[1 5 3;1/5 1 1/3;1/3 3 1]; [w52,val52]=eigs(a52,1);
w52=w52/sum(w52), cr52=(val52-3)/2/ri(3)
%以下构造超矩阵w
w([1:3],4)=w12; w([1:3],5)=w131; w([1:3],6)=w132;
w([1:3],7)=w133; w([1:3],8)=w134; w([1:3],9)=w141;
w([1:3],10)=w142; w([1:3],11)=w151; w([1:3],12)=w152;
 w([1:3],13)=w153;
 w(4,:)=[ones(1,3) 0 ones(1,4) zeros(1,2),ones(1,3)];
 w([5:8],1)=w311; w([5:8],2)=w312; w([5:8],3)=w313; 
 w([5:8],4)=w32; 
 w([9 10],1)=w41; w([9 10],2)=w42; w([9 10],3)=w42;
 w([11:13],1)=w511; w([11:13],2)=w512;
 %以下部分数据没有计算，从参考文献中直接引用 
 w([5:8],5)=[0.494 0.376 0.079 0.051]';
 w([5 7 8],6)=[0.628 0.087 0.285]';
 w([5 6],7)=[0.167 0.833]'; w(5,8)=1;
 w([5:7],9)=[0.634 0.287 0.079]'; w(7,10)=1;
 w(5,11)=1; w([5:8],12)=[0.317 0.507 0.103 0.073]';
 w(5,13)=1; w(9,[5 6])=1; w(10,[7 8])=1; w(10,[11:13])=1;
 w([11:13],3)=[0.312 0.195 0.493]';
 w([11:13],4)=[0.637 0.105 0.258]';
 w([11:13],5)=[0.657 0.197 0.146]';
 w(11,[6 7 8])=1;
 w(12,11)=1; w([11 13],12)=0.5; w([11 12],13)=[0.6667 0.3333]'; 
 %以下计算加权矩阵
 a1=[1 1/3 5 1/4;3 1 5 1/3;1/5 1/5 1 1/9;4 3 9 1];
[w1,val1]=eigs(a1,1); w1=w1/sum(w1),cr1=(val1-4)/3/ri(4)
a2=[1 3 2;1/3 1 1/3;1/2 3 1];
[w2,val2]=eigs(a2,1); w2=w2/sum(w2), cr2=(val2-3)/2/ri(3)
a3=[1 4 3 9 2;1/4 1 1/3 5 1/4;1/3 3 1 5 1/3;1/9 1/5 1/5 1 1/9;1/2 4 3 9 1];
[w3,val3]=eigs(a3,1); w3=w3/sum(w3),cr3=(val3-5)/4/ri(5)
a4=[1 5;1/5 1]; [w4,val4]=eigs(a4,1); w4=w4/sum(w4)
a5=[1 3 6 9 3;1/3 1 1/3 5 1/2;1/6 3 1 5 1/3;1/9 1/5 1/5 1 1/9;1/3 2 3 9 1];
[w5,val5]=eigs(a5,1); w5=w5/sum(w5), cr5=(val5-5)/4/ri(5)
ww=zeros(5); %权重矩阵初始化
ww([2:5],1)=w1; ww([1 3 5],2)=w2; ww(:,3)=w3; 
ww([1 3],4)=w4; ww(:,5)=w5;
index=[3 1 4 2 3]; A=cell(5); %构造权重矩阵A
for i=1:5
    for j=1:5
        A{i,j}=ones(index(i),index(j))*ww(i,j);
    end
end
A=cell2mat(A); %构造与超矩阵同维数的权重矩阵
sw=w.*A; %计算加权超矩阵sw
[f,val]=eigs(sw,1); nf=f/sum(f); %归一化 
ff=nf(1:3)/sum(nf(1:3)) %计算权重向量
xlswrite('aa.xls',w,1), %把数据写入Excel文件的表单“Sheet1”
xlswrite('aa.xls',ww,2), xlswrite('aa.xls',sw,3)
xlswrite('aa.xls',nf,3,'P1') %把nf写入表单“Sheet3”的“P1”开始的数据域
